---
const {
  title,
  subtitle,
  tags = [],
  href = null,              // external link (optional)
  class: className = "",
  id = "",
} = Astro.props;
---

<article
  data-bento-card
  class={`relative rounded-3xl border border-neutral-200 bg-white shadow-[var(--shadow-soft)] ${className}`}
>
  <!-- Expand button (excluded from spotlight clone) -->
  <button
    type="button"
    data-expand
    data-no-spotlight
    aria-label="Spotlight this card"
    class="absolute top-4 right-4 inline-flex items-center justify-center w-7 h-7 rounded-full border border-neutral-200 bg-white/90 backdrop-blur hover:bg-white"
  >
    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" aria-hidden="true">
      <path d="M9 5H5v4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 5h4v4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M9 19H5v-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 19h4v-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>

  <!-- Everything inside here will be cloned into the spotlight modal -->
  <div data-card-clone class="p-6 sm:p-7 md:p-8">
    <!-- Header row (reserve space for the expand button on the right) -->
    <div class="pr-12 flex items-start justify-between gap-3">
      <div>
        {title && <p class="font-display text-xl font-semibold tracking-tight">{title}</p>}
        {subtitle && <p class="mt-1 text-sm text-neutral-500">{subtitle}</p>}
      </div>

      {href && (
        <a
          href={href}
          target="_blank"
          rel="noreferrer"
          aria-label="Open external link"
          data-no-spotlight
          class="mt-0.5 inline-flex items-center justify-center w-7 h-7 rounded-full border border-neutral-200 bg-white text-neutral-600 hover:text-neutral-900 hover:border-neutral-300 shrink-0"
        >
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M7 17L17 7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M7 7h10v10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </a>
      )}
    </div>

    <div class="mt-5 max-w-[78ch] text-sm leading-relaxed">
      <slot />
    </div>

    {tags?.length ? (
      <div class="mt-6 pt-4 border-t border-neutral-100 flex flex-wrap gap-2">
        {tags.map((tag) => (
          <span class="rounded-full border border-neutral-200 bg-neutral-50 px-2.5 py-0.5 text-xs font-medium text-neutral-600">{tag}</span>
        ))}
      </div>
    ) : null}
  </div>
</article>
